<script>
  // SVG we’ll reuse
  const clockSvg = `<svg class="i i-clock" viewBox="0 0 24 24"><circle cx="12" cy="12" r="9"/><path d="M12 7v5l3 2"/></svg>`;

  function renderNextMatches(){
    const rows=[...document.querySelectorAll('#fxTable tbody tr')]
      .filter(tr => tr.style.display !== 'none'); // respect league filter

    const items=rows.slice(0,3).map(tr=>{
      const d=tr.children[0].textContent.trim();
      const opp=tr.children[1].textContent.trim();
      const grd=tr.children[2].textContent.trim();
      const lg=tr.dataset.league||'';
      const time = tr.dataset.time ? 
        ` <span class="time">${clockSvg} ${tr.dataset.time}</span>` : '';
      return `<div class="next-item"><span class="lg">${lg}</span> ${d}${time} – ${opp}<br><small>${grd}</small></div>`;
    }).join('');
    document.getElementById('next-matches').innerHTML=items||'<div class="next-item">No upcoming matches.</div>';
  }

  // Add a clock in the Fixtures “Time” column automatically
  function decorateTimes(){
    document.querySelectorAll('#fxTable tbody tr').forEach(tr=>{
      const td = tr.children[6]; // 7th column = Time
      if (!td) return;
      const t = td.textContent.trim();
      if (t && !td.dataset.iconized){
        td.innerHTML = `<span class="time">${clockSvg} ${t}</span>`;
        td.dataset.iconized = "1";
      }
    });
  }

  // Keep your existing calls; just ensure both run after DOM ready:
  document.addEventListener('DOMContentLoaded', ()=>{
    renderNextMatches();
    decorateTimes();
  });

  // If you filter by league, re-render + re-decorate:
  function filterLeague(lg){
    document.querySelectorAll('#fxTable tbody tr').forEach(tr=>{
      tr.style.display = (lg==='ALL'||tr.dataset.league===lg)?'':'none';
    });
    renderNextMatches();
    decorateTimes();
  }
</script>
